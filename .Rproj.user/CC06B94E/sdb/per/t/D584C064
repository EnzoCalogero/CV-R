{
    "contents" : "---\ntitle: \"DFW1 Jobs Analysis Waiting Jobs (WJxH) Report\"\noutput: html_document\n---\n\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  library(dygraphs)\n  library(data.table)\n  library(dplyr)\n  library(xts)\n  library(lubridate) #Date management\n  library(ggplot2)\n  library(tidyr)\nlibrary(reshape2)\nlibrary(DT)\nday_=15   #days used for the report\nhours_=9  #until what time in the morning used for the computation  \nentry_=0 #Number of lines to be used for generating the graphs.\n#print(\"Created on\")\nnow()\n```\n\n```{r,echo=FALSE, ,message=FALSE,fig.height=6,fig.width=12,warning=FALSE}\n\n  ##import the file\n  file='c:/dati/Jobs_Analisis/dfw1/globalJobsdfw1A.csv'\n  #Jobs_RAW <- read.csv(file,sep=\",\")\n  \nJobs_RAW <- fread(file, header = T, sep = ',')\n  #View(Jobs_RAW)\n  Jobs_RAW$Date.and.Time<-ymd_hms(Jobs_RAW$Date)\n  Jobs_RAW$Date.and.Time<-floor_date(Jobs_RAW$Date.and.Time, \"hour\")\n  Jobs_RAW<-subset(Jobs_RAW,Jobs_RAW$Status== \"Waiting\")\n#  View(Jobs_RAW)\n  \n# Creazione Dataframe per singolo Day\n  Jobs_night<-Jobs_RAW\n  Jobs_night$hours<-hour(Jobs_night$Date.and.Time)\n  Jobs_night<-subset(Jobs_night,Jobs_night$hours<hours_)\n  Jobs_night$Date.and.Time<-floor_date(Jobs_night$Date.and.Time, \"day\")\n  #Jobs_night<-subset(Jobs_night,Jobs_night$Status== \"Waiting\")\n  \n#Espansione per i dati generici...  \ndata_wide <- dcast(Jobs_RAW, Date.and.Time + Status+CS  ~ `Storage Policy`,max, value.var=\"Number\")\n#View(data_wide)\n#rm(Jobs_RAW)\n#data_wide<-subset(data_wide,data_wide$Status== \"Waiting\")\ndata_wide<-subset(data_wide,data_wide$Date.and.Time> ymd_hms(now()-days(day_)))\n\n#Creazione per night dataframe\n#data_night<-subset(data_night,data_night$Status== \"Waiting\")\n\ndata_night <- dcast(Jobs_night, Date.and.Time + Status+CS  ~ `Storage Policy`,max, value.var=\"Number\")\n#data_night<-subset(data_night,data_night$Status== \"Waiting\")\ndata_night<-subset(data_night,data_night$Date.and.Time> ymd_hms(now()-days(day_)))\n\n```\n\n```{r,echo=FALSE,message=FALSE,warning=FALSE,fig.height=6,fig.width=12}\n#Preparazione data frame per Job Wait x Hour\nJobs_night$`Storage Policy`<-paste(Jobs_night$CS, Jobs_night$`Storage Policy`)\nJobs_night_Daily<-aggregate(Number~Date.and.Time+CS+`Storage Policy`,sum,data=Jobs_night)\n\nJobs_night_Daily<-subset(Jobs_night_Daily,Jobs_night_Daily$Date.and.Time > ymd_hms(now()-days(day_)))\n\n\nJobs_night_Full<-aggregate(Number~`Storage Policy`,sum,data=Jobs_night_Daily)\n\n##Graph \nJobs_night_Daily_C <- dcast(Jobs_night_Daily, Date.and.Time +CS  ~ `Storage Policy`,max,value.var=\"Number\")\n\nxts_night_Daily_C<-xts(Jobs_night_Daily_C[,-1],order.by=Jobs_night_Daily_C$Date.and.Time)\n\n\n```\n\n\n*****\n\n## Last `r day_ ` Days SPs Big Offenders\n### (WJxH Integral Aggregated for the `r day_ ` Last Days)\n\n*****\n\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\nJobs_night_Full$WJxH<-Jobs_night_Full$Number\nJobs_night_Full$Number<-NULL\n\n#Jobs_night_Full<-Jobs_night_Full[ order(Jobs_night_Full$WJxH),]\ndatatable(Jobs_night_Full,options = list(rownames = FALSE,order=list(2,'des'),pageLength = 10))\n```\n\n*****\n*****\n*****\n\n## All WJxH Daily Entries for the last `r day_ ` Days \n### (WJxH Integral for Each Single Day)\n\n*****\n\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\nJobs_night_Daily$WJxH<-Jobs_night_Daily$Number\nJobs_night_Daily$Number<-NULL\nJobs_night_Daily$`Week Day`<-wday(Jobs_night_Daily$Date.and.Time, label=TRUE)\nJobs_night_Daily$Date.and.Time<-as.Date(Jobs_night_Daily$Date.and.Time)\nJobs_night_Daily<-Jobs_night_Daily[c('Date.and.Time','Week Day','Storage Policy','WJxH')]\ndatatable(Jobs_night_Daily,options = list(rownames = FALSE,order=list(4,'des'),pageLength = 15))\n\n#dygraph(xts_night_Daily_C,main=\"xts_night_Daily_C\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"always\", hideOnMouseOut = FALSE)\n```\n\n*****\n*****\n*****\n\n# Waiting jobs Time Series for CSs (with #[WJxH] > `r entry_`) \n\n*****\n\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS401\ndata_widet<-subset(data_wide,data_wide$CS== \"CS01\")\nif(nrow(data_widet)>entry_){ \n   xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n   dygraph(xts_Jobs,main=\"CS01 Waiting Jobs\")%>% dyRangeSelector() %>%\n     dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS401\")\n#if(nrow(data_nightT)>0){  \n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n# dygraph(xts_Jobs,main=\"CS401 Saturation Index\")%>% dyRangeSelector() %>% dyLegend(show = \"follow\")\n\n#}\n\n```\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS402\ndata_widet<-subset(data_wide,data_wide$CS== \"CS07\")\nif(nrow(data_widet)>entry_){  \n   xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n   dygraph(xts_Jobs,main=\"CS07\")%>% dyRangeSelector() %>%\n     dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS402\")\n# if(nrow(data_nightT)>0){ \n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#dygraph(xts_Jobs,main=\"CS402\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"follow\")\n#}\n```\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS903\ndata_widet<-subset(data_wide,data_wide$CS== \"CS12\")\nif(nrow(data_widet)>entry_){  \n  \n  xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n  dygraph(xts_Jobs,main=\"CS12\")%>% dyRangeSelector() %>%\n    dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS403\")\n#if(nrow(data_nightT)>0){\n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#dygraph(xts_Jobs,main=\"CS403\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"follow\")\n#}\n\n```\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS404\ndata_widet<-subset(data_wide,data_wide$CS== \"CS20\")\nif(nrow(data_widet)>entry_){  \n\n  xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n  dygraph(xts_Jobs,main=\"CS20\")%>% dyRangeSelector() %>%\n    dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS404\")\n#if(nrow(data_nightT)>0){  \n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#dygraph(xts_Jobs,main=\"CS404\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"follow\")\n#}\n```\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS406\ndata_widet<-subset(data_wide,data_wide$CS== \"CS21\")\nif(nrow(data_widet)>entry_){  \n  \n  xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n  dygraph(xts_Jobs,main=\"CS21\")%>% dyRangeSelector() %>%\n    dyLegend(show = \"follow\")\n}\n####night data\n\n#  data_nightT<-subset(data_night,data_night$CS== \"CS406\")\n#if(nrow(data_nightT)>0){  \n#  xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#  dygraph(xts_Jobs,main=\"CS406\")%>% dyRangeSelector() %>%\n#    dyLegend(show = \"follow\")\n#}\n\n```\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS410\ndata_widet<-subset(data_wide,data_wide$CS== \"AONCS\")\nif(nrow(data_widet)>entry_){  \n\n   xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n   dygraph(xts_Jobs,main=\"AONCS\")%>% dyRangeSelector() %>%\n    dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS410\")\n#if(nrow(data_nightT)>0){  \n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#dygraph(xts_Jobs,main=\"CS410\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"follow\")\n#}\n```\n\n*****\n```{r,echo=FALSE,message=FALSE,fig.height=6,fig.width=12}\n  #CS410\ndata_widet<-subset(data_wide,data_wide$CS== \"CS41\")\nif(nrow(data_widet)>entry_){  \n\n   xts_Jobs<-xts(data_widet[,-1],order.by=data_widet$Date.and.Time)\n   dygraph(xts_Jobs,main=\"CS41\")%>% dyRangeSelector() %>%\n    dyLegend(show = \"follow\")\n}\n####night data\n\n#data_nightT<-subset(data_night,data_night$CS== \"CS410\")\n#if(nrow(data_nightT)>0){  \n#xts_Jobs<-xts(data_nightT[,-1],order.by=data_nightT$Date.and.Time)\n\n#dygraph(xts_Jobs,main=\"CS410\")%>% dyRangeSelector() %>%\n#  dyLegend(show = \"follow\")\n#}\n```\n",
    "created" : 1455312780403.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "82718723",
    "id" : "D584C064",
    "lastKnownWriteTime" : 1461490038,
    "path" : "C:/Users/enzo7311/Desktop/cv_R/CV-R/WJxH_DFW1.Rmd",
    "project_path" : "WJxH_DFW1.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}