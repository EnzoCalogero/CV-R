{
    "contents" : "ReadODBC_Jobs<-function(){\n  library(RODBC)\n  library(lubridate) \n  library(xts)\n  library(dygraphs)\n  library(dplyr)\n   library(ggplot2)\n  library(tidyr)\n  library(reshape2)\n  DBconn <- odbcConnect(\"cs401\",uid='backup-tools',pwd= '4vwnP5Bo')\n\n  Jobs<-sqlQuery(DBconn,paste(\"SELECT [jobinitfrom],[clientname],[idataagent],[data_sp],[jobstatus],[backuplevel],[startdate],[enddate],[durationunixsec],[numstreams],[numbytesuncomp],[numbytescomp],[numobjects],[totalBackupSize] FROM [commserv].[dbo].[CommCellBackupInfo] where [startdate] > '2016-03-01 00:00:00'\")) \n # Jobs<-sqlQuery(DBconn,paste(\"SELECT * FROM [commserv].[dbo].[CommCellBackupInfo] where [startdate] > '2016-03-01 00:00:00'\")) \n  \n  #where [commserv].[dbo].[CommCellBackupInfo].[startdate]\")\n  odbcClose(DBconn)\n  \n  View(Jobs)\n  Jobs$numbytesuncomp<-(Jobs$numbytesuncomp/1024^4)\n  Jobs$numbytescomp<-(Jobs$numbytescomp/1024^4)\n  Jobs$startdate<-ymd_hms(Jobs$startdate)\n  print(\"222\")\n  Jobs$startdate<-floor_date(Jobs$startdate, \"hour\")\n  View(Jobs)\n  jobs_AGG_h<-Jobs%>%group_by(startdate,data_sp)%>%summarise(numbytesuncomp=sum(numbytesuncomp),durationunixsec=sum(durationunixsec),numbytescomp=sum(numbytescomp),totalBackupSize=sum(totalBackupSize))\n # jobs_AGG_h$startdate<-(numbytesuncomp$startdate/1024^3)\n  numbytesuncomp <- dcast(jobs_AGG_h, startdate  ~ `data_sp`,max, value.var=\"numbytesuncomp\")\n  View(numbytesuncomp)\n  numbytesuncomp<-xts(numbytesuncomp[,-1],order.by=numbytesuncomp$startdate)\n # numbytesuncomp$numbytesuncomp<-(numbytesuncomp$numbytesuncomp/1024^3)\n  dygraph(numbytesuncomp,main=\"numbytesuncomp\",group = \"LON3\")%>% dyRangeSelector()#%>%\n # return(jobs_AGG_h)\n  #comp\n  numbytescomp <- dcast(jobs_AGG_h, startdate  ~ `data_sp`,max, value.var=\"numbytescomp\")\n  View(numbytescomp)\n  numbytescomp<-xts(numbytescomp[,-1],order.by=numbytescomp$startdate)\n  # numbytesuncomp$numbytesuncomp<-(numbytesuncomp$numbytesuncomp/1024^3)\n  dygraph(numbytescomp,main=\"numbytescomp\",group = \"LON3\")%>% dyRangeSelector()#%>%\n  # return(jobs_AGG_h)\n  \n}\n\nReadODBC_DDB<-function(){\n  library(RODBC)\n  library(lubridate) \n  library(xts)\n  library(dygraphs)\n  # user <- readline(\"What is the User?\")\n  #  password <- readline(\"What is the Password?\")\n  \n  DBconn <- odbcConnect(\"cs401\",uid='backup-tools',pwd= '4vwnP5Bo')\n  #DBconn <- odbcConnect(\"comm01_commserv\",uid='sa',pwd='password')\n  \n#  Jobs<-sqlQuery(DBconn,paste(\"SELECT [jobinitfrom],[clientname],[idataagent],[data_sp],[jobstatus],[backuplevel],[startdate],[enddate],[durationunixsec],[numstreams],[numbytesuncomp],[numbytescomp],[numobjects] FROM [commserv].[dbo].[CommCellBackupInfo] where [startdate] > '2015-12-12 00:00:00'\")) \n  \n  query=\"SELECT  [SIDBStoreId],[SubStoreId],[HistoryType],[ModifiedTime],\n[PrimaryEntries],[SecondaryEntries],[AvgQITime],[AvgQITimeSampleCount],[NumOfConnections],[ZeroRefCount],\n[DataSizeToPrune],[SizeOccupied],[DDBManagedSize],  [DeleteChunkCount]\nFROM [commserv].[dbo].[IdxSIDBUsageHistory]\"\n  \n  DDB<-sqlQuery(DBconn,query)  \n  \n  #where [commserv].[dbo].[CommCellBackupInfo].[startdate]\")\n  odbcClose(DBconn)\n  View(DDB)\n  DDB$ModifiedTime<-as.POSIXlt(as.numeric(DDB$ModifiedTime),origin=\"1970-01-01\",tz=\"GMT\")\n  View(DDB)\n  DDB$ModifiedTime<-ymd_hms(DDB$ModifiedTime)\n  \n  \n  \n  DDB<-subset(DDB,DDB$SIDBStoreId==30)\n  DDB<-subset(DDB,DDB$ModifiedTime>ymd_hms(now()- days(30)))\n  DDB$AvgQITimeL<-log(DDB$AvgQITime+1)\n # hr.means <- aggregate(DDB$AvgQITimeL, format(time(xts_Insert),\"%y-%m-%d %H\"), mean) \n  \n  \n  xts_Insert<-xts(DDB$AvgQITimeL,order.by=DDB$ModifiedTime)\n  View(xts_Insert)\n  dygraph(xts_Insert,main=\"CS401 Insert\")%>% dyRangeSelector()\n  \n  --------------\n    X2<-xts_Insert\n    hr.mean<-period.apply(X2, endpoints(X2, \"hours\"), mean)\n    aa<-ts(hr.mean,frequency = 24)\n    fit<-stl(aa[,1],s.window=24)\n    plot(fit)\n    \n    \n    xts_Insert_h<-xts(hr.means[,1],order.by=hr.means[,0])\n  \n  dygraph(hr.means,main=\"CS401 Insert hour\")%>% dyRangeSelector()\n  \n    \n---------------    \n  \n  xts_zeroRef<-xts(DDB$ZeroRefCount,order.by=DDB$ModifiedTime)\n  View(xts_zeroRef)\n  dygraph(xts_zeroRef,main=\"Insert\")%>% dyRangeSelector()\n  \n  xts_dataProne<-xts(DDB$DataSizeToPrune,order.by=DDB$ModifiedTime)\n  View(xts_dataProne)\n  dygraph(xts_dataProne,main=\"data to Prone\")%>% dyRangeSelector()\n  \n  DDB$ratio<-100*DDB$ZeroRefCount/DDB$PrimaryEntries\n  xts_ratio<-xts(DDB$ratio,order.by=DDB$ModifiedTime)\n  View(xts_ratio)\n  dygraph(xts_ratio,main=\"Ratio\")%>% dyRangeSelector()\n  \n  DDB$DEDUPratio<-DDB$SecondaryEntries/DDB$PrimaryEntries  \n  xts_DEdupratio<-xts(DDB$DEDUPratio,order.by=DDB$ModifiedTime)\n  View(xts_DEdupratio)\n  dygraph(xts_DEdupratio,main=\"DEDUPRatio\")%>% dyRangeSelector()\n  return(DDB)\n}",
    "created" : 1455365867045.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "1772864865",
    "id" : "8A4430A7",
    "lastKnownWriteTime" : 1457443429,
    "path" : "C:/Users/enzo7311/Desktop/cv_R/CV-R/ODBC.R",
    "project_path" : "ODBC.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}